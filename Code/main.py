# Custom Imports
from sbox import SBox
# from ga import GeneticOptimization

# Python librart imports
import numpy as np
"""
wh_matrix = None

def object_generator():
	global wh_matrix

	default_m = 6
	default_n = 4
	default_mapping = range(2**default_m)
	
	if wh_matrix is None:
		new_object = SBox(default_m, default_n, np.random.permutation(default_mapping))
		new_object.generate_wh()
		wh_matrix = new_object.wh_matrix
	else:
		new_object = SBox(default_m, default_n, np.random.permutation(default_mapping), wh_matrix)

	return new_object


# 1. SBox equations
m = 4
n = 4
# 2. Generate Map
mapping = [0] * (2**m)

mapping[0] = 0xF
mapping[1] = 0x7
mapping[2] = 0xD
mapping[3] = 0x5
mapping[4] = 0x8
mapping[5] = 0x0
mapping[6] = 0xA
mapping[7] = 0x2
mapping[8] = 0xB
mapping[9] = 0x3
mapping[10] = 0x9
mapping[11] = 0x1
mapping[12] = 0xC
mapping[13] = 0x4
mapping[14] = 0x0
mapping[15] = 0xE

"""
# def modval(x):
# 	return x % 16
# 3. Generate Lat & Dat
temp = [
	[85, 163, 206, 253, 94, 184, 33, 69, 212, 68, 51, 122, 89, 180, 136, 201, 83, 167, 250, 238, 90, 157, 128, 124, 92, 150, 223, 35, 144, 96, 95, 112, 105, 139, 210, 137, 59, 24, 161, 1, 43, 165, 118, 30, 148, 240, 121, 198, 169, 55, 63, 17, 147, 162, 228, 156, 192, 179, 47, 208, 81, 143, 98, 215, 230, 131, 127, 239, 133, 72, 152, 193, 164, 120, 7, 188, 216, 116, 166, 140, 64, 129, 177, 38, 54, 31, 60, 196, 186, 0, 224, 242, 251, 134, 176, 254, 236, 101, 5, 41, 142, 62, 39, 19, 218, 23, 190, 200, 9, 209, 226, 21, 108, 66, 103, 42, 246, 56, 146, 58, 145, 158, 12, 25, 75, 194, 130, 93, 14, 222, 114, 233, 138, 207, 8, 110, 2, 149, 79, 241, 10, 173, 48, 168, 27, 160, 219, 155, 153, 159, 178, 221, 172, 111, 213, 237, 225, 99, 50, 235, 204, 82, 26, 80, 76, 109, 183, 40, 199, 203, 234, 252, 245, 248, 71, 70, 78, 104, 174, 232, 202, 46, 65, 49, 217, 197, 211, 77, 125, 15, 3, 229, 220, 91, 16, 44, 175, 205, 67, 73, 132, 151, 182, 36, 22, 249, 102, 88, 247, 141, 52, 32, 243, 86, 97, 187, 45, 115, 123, 28, 170, 113, 84, 100, 154, 227, 181, 34, 255, 18, 171, 37, 191, 214, 20, 4, 106, 29, 185, 11, 189, 231, 61, 53, 135, 195, 13, 87, 119, 57, 74, 107, 117, 244, 126, 6],
[85, 163, 253, 94, 184, 33, 69, 212, 68, 51, 122, 89, 180, 136, 201, 83, 167, 250, 238, 90, 157, 128, 124, 92, 150, 223, 62, 144, 96, 95, 112, 105, 139, 210, 137, 59, 24, 161, 1, 43, 165, 118, 110, 148, 240, 121, 198, 169, 55, 63, 17, 147, 162, 228, 156, 192, 179, 47, 208, 81, 143, 98, 215, 230, 131, 127, 239, 133, 72, 152, 193, 164, 120, 7, 188, 216, 116, 166, 140, 64, 129, 177, 38, 54, 31, 60, 196, 186, 0, 224, 242, 251, 134, 176, 254, 236, 101, 5, 41, 142, 35, 39, 19, 218, 23, 190, 200, 9, 209, 226, 21, 108, 66, 103, 42, 246, 56, 146, 58, 145, 158, 12, 25, 75, 194, 130, 93, 14, 222, 114, 233, 138, 207, 8, 30, 2, 149, 79, 241, 10, 173, 48, 168, 27, 160, 219, 155, 153, 159, 178, 221, 172, 111, 213, 99, 50, 235, 204, 82, 26, 80, 76, 109, 183, 195, 199, 203, 234, 252, 245, 248, 71, 70, 78, 104, 174, 232, 202, 46, 65, 49, 217, 206, 197, 211, 77, 125, 15, 3, 229, 225, 220, 91, 16, 237, 44, 175, 205, 67, 73, 132, 151, 182, 36, 22, 249, 102, 88, 247, 141, 52, 32, 243, 86, 97, 187, 45, 115, 123, 28, 170, 113, 84, 100, 154, 227, 181, 34, 255, 18, 171, 37, 6, 189, 214, 231, 29, 4, 40, 74, 20, 61, 11, 191, 117, 126, 106, 185, 244, 13, 87, 57, 53, 107, 119, 135],
[85, 163, 253, 94, 184, 33, 69, 212, 68, 51, 122, 89, 180, 136, 201, 83, 167, 250, 238, 90, 157, 128, 124, 92, 150, 223, 62, 144, 96, 95, 112, 105, 139, 210, 137, 59, 24, 161, 1, 43, 165, 118, 110, 148, 240, 121, 198, 169, 55, 63, 17, 147, 162, 228, 156, 192, 179, 47, 208, 81, 143, 98, 215, 230, 131, 127, 239, 133, 72, 152, 193, 164, 120, 7, 188, 216, 116, 166, 140, 64, 129, 177, 38, 54, 31, 60, 196, 186, 0, 224, 242, 251, 134, 176, 254, 236, 101, 5, 41, 142, 35, 39, 19, 218, 23, 190, 200, 9, 209, 226, 21, 108, 66, 103, 42, 246, 56, 146, 58, 145, 158, 12, 25, 75, 194, 130, 93, 14, 222, 114, 233, 138, 207, 8, 30, 2, 149, 79, 241, 10, 173, 48, 168, 27, 160, 219, 155, 153, 159, 178, 221, 172, 111, 213, 99, 50, 235, 204, 82, 26, 80, 76, 109, 183, 195, 199, 203, 234, 252, 245, 248, 71, 70, 78, 104, 174, 232, 202, 46, 65, 49, 217, 206, 197, 211, 77, 125, 15, 3, 229, 225, 220, 91, 16, 237, 44, 175, 205, 67, 73, 132, 151, 182, 36, 22, 249, 102, 88, 247, 141, 52, 32, 243, 86, 97, 187, 45, 115, 123, 28, 170, 113, 84, 100, 154, 227, 181, 34, 255, 18, 171, 37, 6, 189, 214, 231, 29, 4, 40, 74, 20, 61, 11, 191, 117, 126, 106, 185, 244, 13, 87, 57, 53, 107, 119, 135],
[85, 163, 253, 94, 184, 33, 69, 212, 68, 51, 122, 89, 180, 136, 201, 83, 167, 250, 238, 90, 157, 128, 124, 92, 150, 223, 62, 144, 96, 95, 112, 105, 139, 210, 137, 59, 24, 161, 70, 195, 228, 8, 41, 243, 72, 2, 217, 54, 35, 19, 36, 192, 48, 126, 145, 53, 211, 11, 131, 1, 218, 75, 235, 50, 84, 37, 93, 22, 230, 87, 170, 237, 5, 111, 204, 186, 239, 21, 194, 3, 221, 32, 7, 178, 27, 45, 76, 193, 116, 56, 154, 207, 106, 196, 245, 29, 185, 134, 169, 43, 142, 215, 52, 12, 148, 17, 23, 224, 34, 200, 146, 189, 219, 18, 82, 165, 118, 110, 240, 121, 198, 55, 63, 147, 162, 156, 179, 47, 208, 81, 143, 98, 127, 133, 152, 164, 120, 188, 216, 166, 140, 64, 129, 177, 38, 31, 60, 0, 242, 251, 176, 254, 236, 101, 9, 39, 190, 209, 226, 108, 66, 103, 42, 246, 58, 158, 25, 130, 14, 222, 114, 233, 138, 30, 149, 79, 241, 10, 173, 168, 160, 155, 153, 159, 172, 213, 99, 26, 80, 109, 183, 199, 203, 234, 252, 248, 71, 78, 104, 174, 232, 202, 46, 65, 49, 206, 197, 77, 125, 15, 229, 225, 220, 91, 16, 44, 175, 205, 67, 73, 132, 151, 182, 249, 102, 88, 247, 141, 86, 97, 187, 115, 123, 28, 113, 100, 227, 181, 255, 171, 191, 214, 20, 4, 107, 74, 244, 117, 57, 231, 40, 6, 61, 119, 13, 135],
[85, 163, 253, 94, 184, 33, 69, 212, 68, 51, 122, 89, 180, 136, 201, 83, 167, 250, 238, 90, 157, 128, 124, 92, 150, 223, 62, 144, 96, 95, 112, 105, 139, 210, 137, 59, 24, 161, 1, 43, 165, 118, 110, 148, 240, 121, 198, 169, 55, 63, 17, 147, 162, 228, 156, 192, 179, 47, 208, 81, 143, 98, 215, 230, 131, 127, 239, 133, 72, 152, 193, 164, 120, 7, 188, 216, 116, 166, 140, 64, 129, 177, 38, 54, 31, 60, 196, 186, 0, 224, 242, 251, 134, 176, 254, 236, 101, 5, 41, 142, 35, 39, 19, 218, 23, 190, 200, 9, 209, 226, 21, 108, 66, 103, 42, 246, 56, 146, 58, 145, 158, 12, 25, 75, 194, 130, 93, 14, 222, 114, 233, 138, 207, 8, 30, 2, 149, 79, 241, 10, 173, 48, 168, 27, 160, 219, 155, 153, 159, 178, 221, 172, 111, 213, 99, 50, 235, 204, 82, 26, 80, 76, 109, 183, 195, 199, 203, 234, 252, 245, 248, 71, 70, 78, 104, 174, 232, 202, 46, 65, 49, 217, 206, 197, 211, 77, 125, 15, 3, 229, 225, 220, 91, 16, 237, 44, 175, 205, 67, 73, 132, 151, 182, 36, 22, 249, 102, 88, 247, 141, 52, 32, 243, 86, 97, 187, 45, 115, 123, 28, 170, 113, 84, 100, 154, 227, 181, 34, 255, 126, 106, 29, 185, 117, 18, 40, 11, 189, 231, 61, 53, 135, 74, 244, 214, 119, 87, 191, 107, 171, 20, 6, 37, 13, 4, 57],
[85, 163, 253, 94, 184, 33, 69, 212, 68, 51, 122, 89, 180, 136, 201, 83, 167, 250, 238, 90, 157, 128, 124, 92, 150, 223, 62, 144, 96, 95, 112, 105, 139, 210, 137, 59, 24, 161, 1, 43, 165, 118, 110, 148, 240, 121, 198, 169, 55, 63, 17, 147, 162, 228, 156, 192, 179, 47, 208, 81, 143, 98, 215, 230, 131, 127, 239, 133, 72, 152, 193, 164, 120, 7, 188, 216, 116, 166, 140, 64, 129, 177, 38, 54, 31, 60, 196, 186, 0, 224, 242, 251, 134, 176, 254, 236, 101, 5, 41, 142, 35, 39, 19, 218, 23, 190, 200, 9, 209, 226, 21, 108, 66, 103, 42, 246, 56, 146, 58, 145, 158, 12, 25, 75, 194, 130, 93, 14, 222, 114, 233, 138, 207, 8, 30, 2, 149, 79, 241, 10, 173, 48, 168, 27, 160, 219, 155, 153, 159, 178, 221, 172, 111, 213, 99, 50, 235, 204, 82, 26, 80, 76, 109, 183, 195, 199, 203, 234, 252, 245, 248, 71, 70, 78, 104, 174, 232, 202, 46, 65, 49, 217, 206, 197, 211, 77, 125, 45, 15, 3, 229, 225, 220, 91, 16, 237, 107, 175, 205, 67, 73, 132, 151, 182, 36, 22, 249, 102, 88, 247, 141, 52, 32, 243, 86, 97, 187, 115, 123, 28, 170, 113, 84, 100, 154, 227, 181, 34, 255, 18, 171, 37, 191, 214, 119, 74, 40, 87, 117, 231, 185, 189, 20, 244, 53, 6, 126, 29, 61, 11, 13, 4, 44, 135, 106, 57],
[85, 163, 253, 94, 184, 33, 69, 212, 68, 51, 122, 89, 246, 136, 201, 83, 167, 250, 238, 90, 157, 128, 124, 92, 150, 223, 35, 144, 96, 95, 112, 105, 139, 210, 137, 59, 24, 161, 1, 43, 165, 118, 110, 148, 240, 121, 198, 169, 55, 63, 17, 147, 162, 228, 156, 192, 179, 47, 208, 81, 143, 98, 215, 230, 131, 127, 239, 133, 72, 152, 193, 164, 120, 7, 188, 216, 116, 166, 140, 180, 64, 129, 177, 38, 174, 54, 31, 60, 196, 186, 0, 224, 242, 251, 134, 176, 254, 236, 101, 5, 41, 142, 62, 39, 19, 218, 23, 190, 200, 9, 209, 226, 21, 108, 66, 103, 42, 56, 146, 58, 145, 158, 12, 25, 75, 194, 130, 93, 14, 222, 114, 233, 138, 207, 8, 30, 2, 149, 79, 241, 10, 173, 48, 168, 27, 160, 219, 155, 153, 159, 178, 221, 172, 111, 213, 99, 50, 235, 204, 82, 26, 80, 76, 109, 183, 195, 199, 203, 234, 252, 245, 248, 71, 70, 78, 104, 232, 202, 46, 65, 49, 217, 206, 197, 211, 77, 125, 15, 3, 229, 225, 220, 91, 16, 237, 44, 175, 205, 67, 73, 132, 151, 182, 36, 22, 249, 102, 88, 247, 141, 52, 32, 243, 86, 97, 187, 45, 115, 123, 28, 170, 113, 84, 100, 154, 227, 181, 34, 255, 18, 171, 37, 191, 214, 117, 11, 6, 40, 244, 13, 4, 87, 61, 231, 57, 53, 107, 189, 185, 20, 119, 74, 126, 135, 29, 106],
[85, 163, 253, 94, 184, 33, 69, 212, 68, 51, 122, 89, 246, 136, 201, 83, 167, 250, 238, 90, 157, 128, 124, 92, 150, 223, 35, 144, 96, 95, 112, 105, 139, 210, 137, 59, 24, 161, 1, 43, 165, 118, 110, 148, 240, 121, 198, 169, 55, 63, 17, 147, 162, 228, 156, 192, 179, 47, 208, 81, 143, 98, 215, 230, 131, 127, 239, 133, 72, 152, 193, 164, 120, 7, 188, 216, 116, 166, 140, 64, 180, 129, 177, 38, 54, 31, 60, 196, 186, 0, 224, 242, 251, 134, 176, 254, 236, 101, 5, 41, 142, 62, 39, 19, 218, 23, 190, 200, 9, 209, 226, 21, 108, 66, 103, 42, 56, 146, 58, 145, 158, 12, 25, 75, 194, 130, 93, 14, 222, 114, 233, 138, 207, 8, 30, 2, 149, 79, 241, 10, 173, 48, 168, 27, 160, 219, 155, 153, 159, 178, 221, 172, 111, 213, 99, 50, 235, 204, 82, 26, 80, 76, 109, 183, 195, 199, 203, 234, 252, 245, 248, 71, 70, 78, 104, 174, 232, 202, 46, 65, 49, 217, 206, 197, 211, 77, 125, 15, 3, 229, 225, 220, 91, 16, 237, 44, 175, 205, 67, 73, 132, 151, 182, 36, 22, 249, 102, 88, 247, 141, 52, 32, 243, 86, 97, 187, 45, 115, 123, 28, 170, 113, 84, 100, 154, 227, 181, 34, 255, 18, 171, 37, 191, 214, 20, 4, 107, 189, 53, 74, 244, 106, 117, 57, 231, 40, 126, 29, 6, 185, 61, 87, 11, 119, 13, 135],
[85, 163, 253, 94, 184, 33, 69, 212, 68, 51, 122, 89, 246, 136, 201, 83, 167, 250, 238, 90, 157, 128, 124, 92, 150, 223, 35, 144, 96, 95, 112, 105, 139, 210, 137, 59, 24, 161, 1, 43, 165, 118, 110, 148, 240, 121, 198, 169, 55, 63, 17, 147, 162, 228, 156, 192, 179, 47, 208, 81, 143, 98, 215, 230, 131, 127, 239, 133, 72, 152, 193, 164, 120, 7, 188, 216, 116, 166, 140, 64, 129, 177, 38, 54, 31, 60, 196, 186, 0, 224, 242, 251, 134, 176, 254, 236, 101, 5, 41, 142, 62, 39, 19, 218, 23, 190, 200, 9, 209, 226, 21, 108, 66, 103, 42, 180, 56, 146, 58, 145, 158, 12, 25, 75, 194, 130, 93, 14, 222, 114, 233, 138, 207, 8, 30, 2, 149, 79, 241, 10, 173, 48, 168, 27, 160, 219, 155, 153, 159, 178, 221, 172, 111, 213, 99, 50, 235, 204, 82, 26, 80, 76, 109, 183, 195, 199, 203, 234, 252, 245, 248, 71, 70, 78, 104, 174, 232, 202, 46, 65, 49, 217, 206, 197, 211, 77, 125, 15, 3, 229, 225, 187, 243, 36, 126, 53, 11, 84, 37, 22, 87, 170, 237, 32, 45, 154, 106, 29, 185, 52, 34, 189, 18, 6, 107, 40, 88, 181, 214, 100, 249, 231, 16, 86, 220, 4, 91, 182, 132, 102, 74, 20, 61, 205, 115, 44, 175, 67, 113, 227, 28, 119, 73, 97, 57, 244, 123, 13, 117, 255, 151, 191, 135, 171, 247, 141],
[85, 163, 253, 94, 184, 33, 69, 212, 68, 51, 122, 89, 180, 136, 201, 83, 167, 250, 238, 90, 157, 128, 124, 92, 150, 223, 35, 144, 96, 95, 112, 105, 139, 210, 137, 59, 24, 161, 1, 43, 165, 118, 110, 148, 240, 121, 198, 169, 55, 63, 17, 147, 162, 228, 156, 192, 179, 47, 208, 81, 143, 98, 215, 230, 131, 127, 239, 133, 72, 152, 193, 164, 120, 7, 188, 216, 116, 166, 140, 64, 129, 177, 38, 54, 31, 60, 196, 186, 0, 224, 242, 251, 134, 176, 254, 236, 101, 5, 41, 142, 62, 39, 19, 218, 23, 190, 200, 9, 209, 226, 21, 108, 66, 103, 42, 246, 56, 146, 58, 145, 158, 12, 126, 75, 194, 130, 93, 14, 222, 114, 233, 138, 207, 8, 30, 2, 149, 79, 241, 10, 173, 48, 168, 27, 160, 219, 155, 153, 159, 178, 221, 172, 111, 213, 99, 50, 235, 204, 82, 26, 80, 76, 109, 183, 195, 199, 203, 234, 252, 245, 248, 71, 70, 78, 104, 174, 232, 202, 46, 65, 49, 217, 206, 197, 211, 77, 125, 15, 3, 229, 225, 220, 91, 16, 237, 44, 175, 205, 67, 73, 132, 151, 182, 36, 22, 249, 102, 88, 247, 141, 52, 32, 243, 86, 97, 187, 45, 154, 115, 123, 28, 170, 113, 84, 100, 227, 189, 34, 255, 18, 171, 37, 191, 214, 20, 4, 107, 181, 53, 74, 244, 106, 117, 57, 231, 40, 25, 29, 6, 185, 61, 87, 11, 119, 13, 135],
[85, 163, 253, 94, 184, 33, 69, 212, 68, 51, 122, 89, 246, 136, 201, 83, 167, 250, 238, 90, 157, 128, 124, 92, 150, 223, 35, 144, 96, 95, 112, 105, 139, 210, 137, 59, 24, 161, 1, 43, 165, 118, 110, 148, 240, 121, 198, 169, 55, 63, 17, 147, 162, 228, 156, 192, 179, 47, 208, 81, 143, 98, 215, 230, 131, 127, 239, 133, 72, 152, 193, 164, 120, 7, 188, 216, 116, 166, 140, 64, 129, 177, 38, 54, 31, 60, 196, 186, 0, 224, 242, 251, 134, 176, 254, 236, 101, 5, 41, 142, 62, 39, 19, 218, 23, 190, 200, 9, 209, 226, 21, 108, 66, 103, 42, 180, 56, 146, 58, 145, 158, 12, 25, 75, 194, 130, 93, 14, 222, 114, 233, 138, 207, 8, 30, 2, 149, 79, 241, 10, 173, 48, 168, 27, 160, 219, 155, 153, 159, 178, 221, 172, 111, 213, 99, 50, 235, 204, 82, 26, 80, 76, 109, 183, 195, 199, 203, 234, 252, 245, 248, 71, 70, 78, 104, 174, 232, 202, 46, 65, 49, 217, 206, 197, 211, 77, 125, 15, 3, 229, 225, 220, 91, 16, 237, 44, 175, 205, 67, 73, 132, 151, 182, 36, 22, 249, 102, 88, 247, 141, 52, 32, 243, 86, 97, 187, 45, 154, 115, 123, 28, 170, 113, 84, 100, 227, 189, 34, 255, 18, 171, 37, 181, 6, 214, 231, 29, 4, 40, 74, 20, 61, 11, 191, 117, 126, 106, 185, 244, 13, 87, 57, 53, 107, 119, 135],
[85, 163, 253, 94, 184, 33, 69, 212, 68, 51, 122, 89, 246, 136, 201, 83, 167, 250, 238, 90, 157, 128, 124, 92, 150, 223, 35, 144, 96, 95, 112, 105, 139, 210, 137, 59, 24, 161, 1, 43, 165, 118, 110, 148, 240, 180, 121, 198, 225, 55, 63, 17, 147, 162, 228, 156, 192, 179, 47, 208, 81, 143, 98, 215, 230, 131, 127, 239, 133, 72, 152, 193, 164, 120, 7, 188, 216, 116, 166, 140, 64, 129, 177, 38, 54, 31, 60, 196, 186, 0, 224, 242, 251, 134, 176, 254, 236, 101, 5, 41, 142, 62, 39, 19, 218, 23, 190, 200, 9, 209, 226, 21, 108, 66, 103, 42, 56, 146, 58, 145, 158, 12, 25, 75, 194, 130, 93, 14, 222, 114, 233, 138, 207, 8, 30, 2, 149, 79, 241, 10, 173, 48, 168, 27, 160, 219, 155, 153, 159, 178, 221, 172, 111, 213, 99, 50, 235, 204, 82, 26, 80, 76, 109, 183, 195, 199, 203, 234, 252, 245, 248, 71, 70, 78, 104, 174, 232, 202, 46, 65, 49, 217, 206, 197, 211, 77, 125, 15, 3, 229, 169, 220, 91, 16, 237, 44, 175, 205, 67, 73, 132, 151, 182, 36, 22, 249, 102, 88, 247, 141, 52, 32, 243, 86, 97, 187, 45, 115, 123, 28, 170, 113, 84, 100, 154, 227, 181, 34, 255, 18, 171, 37, 191, 214, 20, 4, 126, 106, 29, 185, 11, 189, 6, 40, 13, 231, 117, 74, 61, 53, 135, 87, 119, 57, 107, 244],
[85, 163, 253, 94, 184, 33, 69, 212, 68, 51, 122, 89, 246, 136, 201, 83, 167, 250, 238, 90, 157, 128, 124, 92, 150, 223, 35, 144, 96, 95, 112, 105, 139, 210, 137, 59, 24, 161, 1, 43, 165, 118, 110, 148, 240, 121, 198, 169, 55, 63, 17, 147, 162, 228, 156, 192, 179, 47, 208, 81, 143, 98, 215, 230, 131, 127, 239, 133, 72, 152, 193, 164, 120, 7, 188, 216, 116, 166, 140, 64, 129, 177, 38, 54, 31, 60, 196, 186, 0, 224, 242, 251, 134, 176, 254, 236, 101, 5, 41, 142, 62, 39, 19, 218, 23, 190, 200, 9, 209, 226, 21, 108, 66, 103, 42, 180, 56, 146, 58, 145, 158, 12, 25, 75, 194, 130, 93, 14, 222, 114, 233, 138, 207, 8, 30, 2, 149, 79, 241, 10, 173, 48, 168, 27, 160, 219, 155, 153, 159, 178, 221, 172, 111, 213, 99, 50, 235, 204, 82, 26, 80, 76, 109, 183, 195, 199, 203, 234, 252, 245, 248, 71, 70, 78, 104, 174, 232, 202, 46, 65, 49, 217, 206, 197, 211, 77, 125, 15, 3, 229, 225, 220, 91, 16, 36, 126, 32, 45, 154, 106, 29, 185, 243, 237, 11, 34, 189, 18, 231, 100, 151, 61, 141, 88, 187, 53, 28, 135, 52, 40, 249, 13, 170, 182, 84, 115, 171, 87, 119, 102, 57, 205, 175, 132, 214, 22, 74, 247, 73, 117, 191, 97, 67, 20, 123, 4, 181, 227, 107, 6, 86, 113, 44, 37, 244, 255],
[85, 163, 253, 94, 184, 33, 69, 212, 68, 51, 122, 89, 246, 136, 201, 83, 167, 250, 238, 90, 157, 128, 124, 92, 150, 223, 35, 144, 96, 95, 112, 105, 139, 210, 137, 59, 24, 161, 1, 43, 165, 118, 110, 148, 240, 121, 198, 169, 55, 63, 17, 147, 162, 228, 156, 192, 179, 47, 208, 81, 143, 98, 215, 230, 131, 127, 239, 133, 72, 152, 193, 164, 120, 7, 188, 216, 116, 166, 140, 64, 129, 177, 38, 54, 31, 60, 196, 186, 0, 224, 242, 251, 134, 176, 254, 236, 101, 5, 41, 142, 62, 39, 19, 218, 23, 190, 200, 9, 209, 226, 21, 108, 66, 103, 42, 180, 56, 146, 58, 145, 158, 12, 25, 75, 194, 130, 93, 14, 222, 114, 233, 138, 207, 8, 30, 2, 149, 79, 241, 10, 173, 48, 168, 27, 160, 219, 155, 153, 159, 178, 221, 172, 111, 213, 99, 50, 235, 204, 82, 26, 80, 76, 109, 183, 195, 199, 203, 234, 252, 245, 248, 71, 70, 78, 104, 174, 232, 202, 46, 65, 49, 217, 206, 197, 211, 77, 125, 15, 3, 229, 225, 220, 91, 16, 237, 44, 175, 205, 67, 73, 132, 151, 182, 36, 22, 249, 102, 88, 247, 141, 52, 32, 243, 86, 97, 187, 45, 154, 115, 123, 28, 170, 113, 84, 100, 227, 189, 34, 255, 18, 171, 37, 191, 214, 20, 4, 107, 181, 53, 74, 244, 106, 117, 57, 231, 40, 126, 29, 6, 185, 61, 87, 11, 119, 13, 135],
[85, 163, 253, 94, 184, 33, 69, 212, 68, 51, 122, 89, 246, 136, 201, 83, 167, 250, 238, 90, 157, 128, 124, 92, 150, 223, 35, 144, 96, 95, 112, 105, 139, 210, 137, 59, 24, 161, 1, 43, 165, 118, 110, 148, 240, 121, 198, 169, 55, 63, 17, 147, 162, 228, 156, 192, 179, 47, 208, 81, 143, 98, 215, 230, 131, 180, 233, 239, 133, 72, 152, 193, 164, 120, 7, 188, 216, 116, 166, 140, 64, 129, 177, 38, 54, 31, 60, 196, 186, 0, 224, 242, 251, 134, 176, 254, 236, 101, 5, 41, 142, 62, 39, 19, 218, 23, 190, 200, 9, 209, 226, 21, 108, 66, 103, 42, 56, 146, 58, 145, 158, 12, 25, 75, 194, 130, 93, 14, 222, 114, 127, 138, 207, 8, 30, 2, 149, 79, 241, 10, 173, 48, 168, 27, 160, 219, 155, 153, 159, 178, 221, 172, 111, 213, 99, 50, 235, 204, 82, 26, 80, 76, 109, 183, 195, 199, 203, 234, 252, 245, 248, 71, 70, 78, 104, 174, 232, 202, 46, 65, 49, 217, 206, 197, 211, 77, 125, 15, 3, 229, 225, 220, 91, 16, 237, 44, 175, 205, 67, 73, 132, 151, 182, 36, 22, 249, 102, 88, 247, 141, 52, 32, 243, 86, 97, 187, 45, 115, 123, 28, 170, 113, 84, 100, 154, 227, 181, 34, 255, 18, 171, 37, 6, 189, 214, 231, 29, 4, 40, 74, 20, 61, 11, 191, 117, 126, 106, 185, 244, 107, 53, 57, 87, 119, 13, 135],
[85, 163, 253, 94, 184, 33, 69, 212, 68, 51, 122, 89, 246, 136, 201, 83, 167, 250, 238, 90, 157, 128, 124, 92, 150, 223, 35, 144, 96, 95, 112, 105, 139, 210, 137, 59, 24, 161, 1, 43, 165, 118, 110, 148, 240, 121, 198, 169, 55, 63, 17, 147, 162, 228, 156, 192, 179, 47, 208, 81, 143, 98, 215, 230, 131, 127, 239, 133, 72, 152, 193, 164, 120, 7, 188, 216, 116, 166, 140, 64, 129, 177, 38, 54, 31, 60, 196, 186, 0, 224, 242, 251, 134, 176, 254, 236, 101, 5, 41, 142, 62, 39, 19, 218, 23, 190, 200, 9, 209, 226, 21, 108, 66, 103, 42, 180, 56, 146, 58, 145, 158, 12, 25, 75, 194, 130, 93, 14, 222, 114, 233, 138, 207, 8, 30, 2, 149, 79, 241, 10, 173, 48, 168, 27, 160, 219, 155, 153, 159, 178, 221, 172, 111, 213, 99, 50, 235, 204, 82, 26, 80, 76, 109, 183, 195, 199, 203, 234, 252, 245, 248, 71, 70, 78, 104, 174, 232, 202, 46, 65, 49, 217, 206, 197, 211, 77, 125, 15, 3, 229, 225, 220, 91, 16, 237, 44, 175, 205, 67, 73, 132, 151, 182, 36, 22, 249, 102, 88, 247, 141, 52, 32, 243, 86, 97, 187, 45, 154, 115, 123, 28, 170, 113, 84, 100, 227, 189, 34, 255, 18, 171, 37, 191, 214, 20, 4, 181, 107, 53, 74, 126, 40, 231, 13, 87, 117, 11, 6, 244, 61, 29, 119, 106, 185, 57, 135]
]

for tabNo in range(16):
	mapping = temp[tabNo] #map(modval,temp[tabNo])
	mysbox = SBox(8, 8, mapping)
	mysbox.generate_wh()
	# print mysbox.wh_matrix
	mysbox.tables()
	# 4. Save lat to file
	fil = open('Output/sbox_8x8.'+str(tabNo), 'w')
	fil.write("Type: 8x8\n\n")
	fil.write("Mapping: ")
	fil.write(str(mapping))
	fil.write("\n\nBalanceness: ")
	fil.write(str(mysbox.balanceness()))
	fil.write("\n\nNon-linearity: ")
	fil.write(str(mysbox.non_linearity()))
	fil.write("\n\nLAT Table:\n")
	vals = mysbox.write_lat_to_file(fil)
	bias = max(abs(2**7-vals[0]),abs(2**7-vals[1])) / float(2**8)
	fil.write("\nBias: "+str(bias))
	fil.close()

	# 5. Save lat to file
	fil = open('Output/sbox_8x8.'+str(tabNo), 'a')
	fil.write("\n\nDAT Table:\n")
	mysbox.write_dat_to_file(fil)
	fil.close()

# print mysbox.non_linearity()
# print mysbox.fitness()


# # 6. Run GA Optimization
# ga = GeneticOptimization(SBox, object_generator)
# best_arr = ga.run(16, 'pop_file')
# for best in best_arr:
# 	print "best: ", best.non_linearity()
# 	print "Valid: ", best.check_bijective()
# 	print best.S
